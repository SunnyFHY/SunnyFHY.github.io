<!DOCTYPE html>
<html lang="null">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  
  <meta name="keywords" content="符涵月">
  <meta name="description" content="南邮本科生">
  
  <title>SunnyFHY</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/materialize.min.css">
    
      <link rel="stylesheet" href="/css/main.min.css">
    
  
  <style type="text/css">
      html{
          font-family: sans-serif;
          font-weight: 300;
      }
      @font-face {
          font-family: 'Material Icons';
          font-style: normal;
          font-weight: 400;
          src: url(/fonts/MaterialIcons-Regular.eot);
          src: url(/fonts/MaterialIcons-Regular.woff2) format('woff2'),
          url(/fonts/MaterialIcons-Regular.woff) format('woff'),
          url(/fonts/MaterialIcons-Regular.ttf) format('truetype')
      }
  </style>
<link rel="shortcut icon" href="/source/favicon.ico">
</head>
<body>
<div id="menu-box"><a href="javascript:void(0)" id="menu" data-activates="slide-out" class="button-collapse menu" ><span class="nav-btn"></span></a></div>
<div id="menu-outer">
  <div id="menu-inner">
      <ul id="slide-out" class="side-nav" >
    <div class="nav-header"  style="background-image: url(/images/Coconutree_Moon.jpg);background-color:#26A69A">
    <div class="header-box"><img src="/images/Spongebob.jpg" ondragstart="return false;"></div>
    <p>SunnyFHY</p>
    <div class="nav-link">
        
        
        <a  href="https://github.com/SunnyFHY" target="_blank"><div class="link-box github"></div></a>
        
        
        
        
    </div>
    <div class="nav-search">
        <form id="search-form"> <!-- 搜索框相关 -->
            <input type="text" id="local-search-input" name="q" results="0" placeholder="搜索..." class="search form-control" autocomplete="off" autocorrect="off"/>
            <div class="nav-search-img"><i class="material-icons">search</i></div>
        </form>
        <div id="local-search-result"></div> <!-- 搜索结果区 -->
        <p class='no-result'>无搜索结果</p>
    </div>
</div>
    <!--Homepage-->

<li class="nav-list">
    <a href="/" target="_self">
        <div class="nav-ico"><i class="material-icons">home</i> </div><p>主页</p>
    </a>
</li>

<!--archives-->

<li class="nav-list dropdown-btn">
    <a  class=""  target="_self">
        <div class="nav-ico"><i class="material-icons">assignment</i></div><p>归档</p><div class="dropdown-ico"><i class="material-icons">arrow_drop_down</i></div>
    </a>
</li>

<ul class="dropdown-menu dropdown" >
    <li class="nav-dropdown-list">
        <a class="archive-link" href="/archives/2018/12/">December 2018<span class="archive-count">2</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2018/10/">October 2018<span class="archive-count">3</span></a>
    </li>
</ul>
<!--categories-->

<li class="nav-list dropdown-btn">
    <a   class=""  target="_self">
        <div class="nav-ico"><i class="material-icons">dashboard</i></div><p>分类</p><div class="dropdown-ico"><i class="material-icons">arrow_drop_down</i></div>
    </a>
</li>

<ul class="dropdown-menu dropdown" >
    <li class="nav-dropdown-list">
        <a class="category-link" href="/categories/VivadoHLS/">VivadoHLS<span class="category-count">2</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/四旋翼/">四旋翼<span class="category-count">1</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/操作系统/">操作系统<span class="category-count">2</span></a>
    </li>
</ul>
<!--tags-->

<!--photo-->

<!--friends-->

<!--about-->

<li class="nav-list">
    <a href="/about" target="_self">
        <div class="nav-ico"><i class="material-icons">copyright</i> </div><p>关于</p>
    </a>
</li>


</ul>

  </div>
</div>

<div id="content-outer">
  <div id="content-inner">
    
<article id="post">
  <div class="post-page-title"  style="background-color:#26A69A;background-image:url(/images/random/vateral-6.png)" >
  <h2>vivadoHLS（一）</h2>
    
  <p>作者:SunnyFHY &nbsp&nbsp 发布于:<time datetime="2018-10-06T05:00:58.000Z">
          2018-10-06
    </time>
  </p>
    
  </div>
  <div class="post-page-content">
  <h1 id="HLS学习"><a href="#HLS学习" class="headerlink" title="HLS学习"></a>HLS学习</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>FPGA又称可编程逻辑门阵列，因为其魔法的并行计算和魔法的可编程逻辑单元阵列，让我产生了兴趣。目前在学数电和verilog。一个月前小伙伴达成共识，要做一个参赛项目。在那个项目里面要全用verilog写的话……恕我直言！太难了(Ｔ▽Ｔ)。所以就开始学这个HLS，在用C转verilog的边缘试探。讲点正经的，这些技术工具本身就是在用户体验感的路上走了！跑了！加速了！底层的东西因为不符合普通人类思维，所以越走越窄。换个角度来说，也可以看做掌握底层的人越来越少。至于这个稀少带来的是价值提升还是被边缘化，这个还是要用发展的眼光去看的。至少现在我认为verilog/VHDL是不能抛弃的，并不是说学了HLS就用不着这些了。HLS也好，verilog/VHDL也好都有其局限性。最关键的还是使用这些工具的人自身的能力和经验。</p>
<h2 id="HLS基础介绍"><a href="#HLS基础介绍" class="headerlink" title="HLS基础介绍"></a>HLS基础介绍</h2><p>高层次综合（HLS）是指自动综合最初用C、C++或SystemC语言描述的数字设计。工程师之所以对高层次综合如此感兴趣，不仅是因为它能让工程师在较高的抽象层面上工作，而且还因为它能方便地生成多种设计解决方案。利用HLS，您能探索各种可能性，分析面积和性能特点，最终确定一个方案在FPGA芯片上实现算法。举例来说，您能探索将存储器映射到Block RAM（BRAM）或分布式RAM上有什么不同的影响，或者分析回路展开以及其它回路相关优化有什么效果，而且不必手动生成不同的寄存器传输级（RTL）设计。您所要做的仅仅是在C/C++/SystemC设计中设置相关指令而已。</p>
<p>赛灵思在其最新发布的Vivado™工具套件中推出了HLS工具。Vivado HLS是AutoESL工具的品牌转型重塑，可提供众多技术帮助您优化C/C++/SystemC代码以实现目标性能。这样的HLS工具就能帮助您在FPGA上快速实现算法，无需借助基于Verilog和VHDL等硬件描述语言的非常耗时的RTL设计方法。</p>
<h2 id="HLS入门学习资料"><a href="#HLS入门学习资料" class="headerlink" title="HLS入门学习资料"></a>HLS入门学习资料</h2><p>第一， 手边的学习资料。</p>
<p>安装Vivado HLS以后， 既包含了20个design example，50个code example:</p>
<p><img src="/2018/10/06/vivadoHLS-0/5096-18984-tupian1.png" alt="img"></p>
<p>第二， step by step教程</p>
<p>ug871 是xilinx公开提供的HLS教程， 包括11个例子：</p>
<p>C Validation<br>Interface Synthesis<br>Arbitrary Precision Types<br>Design Analysis<br>Design Optimization<br>RTL Verification<br>Using HLS IP in IP Integrator<br>Using HLS IP in a Zynq Processor Design<br>Using HLS IP in System Generator for DSP</p>
<p>ug871 ： <a href="http://www.xilinx.com/support/documentation/sw_manuals/xilinx2013_1/ug871-vivado-high-level-synthesis-tutorial.pdf" target="_blank" rel="external">http://www.xilinx.com/support/documentation/sw_manuals/xilinx2013_1/ug87…</a></p>
<p>参考设计源代码： <a href="http://www.xilinx.com/cgi-bin/docs/rdoc?v=2013.2;t=vivado+tutorials" target="_blank" rel="external">http://www.xilinx.com/cgi-bin/docs/rdoc?v=2013.2;t=vivado+tutorials</a></p>
<p><img src="/2018/10/06/vivadoHLS-0/5096-18985-tupian2.png" alt="img"></p>
<p>第三， 13个Xilinx专家讲解视频， 包括讲座和演示</p>
<p>地址： <a href="http://www.xilinx.com/training/vivado" target="_blank" rel="external">www.xilinx.com/training/vivado</a></p>
<p>1.<a href="http://www.origin.xilinx.com/csi/training/vivado/getting-started-with-vivado-high-level-synthesis.htm" target="_blank" rel="external">Getting Started with Vivado High-Level Synthesis</a></p>
<p>2.<a href="http://www.origin.xilinx.com/csi/training/vivado/verifying-your-vivado-hls-design.htm" target="_blank" rel="external">Verifying your Vivado HLS Design</a></p>
<p>3.<a href="http://www.origin.xilinx.com/csi/training/vivado/packaging-vivado-hls-ip-for-use-from-vivado-ip-catalog.htm" target="_blank" rel="external">Packaging Vivado HLS IP for use from Vivado IP Catalog</a></p>
<p>4.<a href="http://www.origin.xilinx.com/csi/training/vivado/generating-vivado-hls-block-for-use-in-system-generator-for-dsp.htm" target="_blank" rel="external">Generating Vivado HLS block for use in System Generator for DSP</a></p>
<p>5.<a href="http://www.origin.xilinx.com/csi/training/vivado/generating-vivado-hls-pcore-for-use-in-xilinx-platform-studio.htm" target="_blank" rel="external">Generating Vivado HLS pcore for use in Xilinx Platform Studio</a></p>
<p>6.<a href="http://www.origin.xilinx.com/csi/training/vivado/analyzing-your-vivado-hls-design.htm" target="_blank" rel="external">Analyzing your Vivado HLS design</a></p>
<p>7.<a href="http://forums.xilinx.com/t5/forums/replypage/board-id/cn-vivado/message-id/%C2%A7%09http:/www.origin.xilinx.com/csi/training/vivado/specifying-axi4-interfaces-for-your-vivado-hls-design.htm" target="_blank" rel="external">Specifying AXI4 interfaces for your Vivado HLS design</a></p>
<p>8.<a href="http://www.origin.xilinx.com/csi/training/vivado/using-vivado-hls-c-in-system-generator.htm" target="_blank" rel="external">Using Vivado HLS C/C++/SystemC block in System Generator</a></p>
<p>9.<a href="http://www.origin.xilinx.com/csi/training/vivado/using-vivado-hls-c-based-pcores-in-xps.htm" target="_blank" rel="external">Using Vivado HLS C/C++/SystemC based pcores in XPS</a></p>
<p>10.<a href="http://www.origin.xilinx.com/csi/training/vivado/floating-point-design-with-vivado-hls.htm" target="_blank" rel="external">Floating-Point Design with Vivado HLS</a></p>
<p>11.<a href="http://www.origin.xilinx.com/csi/training/vivado/using-vivado-hls-software-libraries-in-your-c-code.htm" target="_blank" rel="external">Using Vivado HLS SW libraries in your C, C++, SystemC code</a></p>
<p>12.<a href="http://www.origin.xilinx.com/csi/training/vivado/using-vivado-hls-tcl-interface.htm" target="_blank" rel="external">Using the Vivado HLS Tcl </a><a href="http://www.origin.xilinx.com/csi/training/vivado/using-vivado-hls-tcl-interface.htm" target="_blank" rel="external">interface</a></p>
<p>13.<a href="http://www.xilinx.com/csi/training/vivado/leveraging-opencv-and-high-level-synthesis-with-vivado.htm" target="_blank" rel="external">Leveraging </a><a href="http://www.xilinx.com/csi/training/vivado/leveraging-opencv-and-high-level-synthesis-with-vivado.htm" target="_blank" rel="external">OpenCV</a><a href="http://www.xilinx.com/csi/training/vivado/leveraging-opencv-and-high-level-synthesis-with-vivado.htm" target="_blank" rel="external"> and High Level Synthesis with Vivado</a></p>
<p>第四， 不停更新的武林秘籍</p>
<p><a href="http://www.xilinx.com/hls" target="_blank" rel="external">www.xilinx.com/hls</a></p>
<p><a href="http://www.xilinx.com/support/documentation/application_notes/xapp745-processor-control-vhls.pdf" target="_blank" rel="external">XAPP745 Processor Control of Vivado HLS Designs</a></p>
<p><a href="http://www.xilinx.com/support/documentation/application_notes/xapp793-memory-structures-video-vivado-hls.pdf" target="_blank" rel="external">XAPP793 Implementing Memory Structures for Video Processing in the Vivado HLS Tool</a></p>
<p><a href="http://www.xilinx.com/support/index.htm" target="_blank" rel="external">XAPP599 </a><a href="http://www.xilinx.com/support/index.htm" target="_blank" rel="external">Floating Point Design with Vivado HLS</a></p>
<p><a href="http://www.xilinx.com/support/documentation/application_notes/xapp890-zynq-sobel-vivado-hls.pdf" target="_blank" rel="external">XAPP890 Zynq All Programmable SoC Sobel Filter Implementation Using the Vivado HLS </a><a href="http://www.xilinx.com/support/documentation/application_notes/xapp890-zynq-sobel-vivado-hls.pdf" target="_blank" rel="external">Tool</a></p>
<p><a href="http://www.xilinx.com/support/documentation/application_notes/xapp1163.pdf" target="_blank" rel="external">XAPP1163 - Floating-Point PID Controller Design with Vivado HLS and System Generator for </a><a href="http://www.xilinx.com/support/documentation/application_notes/xapp1163.pdf" target="_blank" rel="external">DSP</a>、</p>
<p><a href="http://www.xilinx.com/support/documentation/application_notes/xapp1167.pdf" target="_blank" rel="external">XAPP1167 </a><a href="http://www.xilinx.com/support/documentation/application_notes/xapp1167.pdf" target="_blank" rel="external">Accelerating OpenCV Applications with Zynq using Vivado HLS Video Libraries</a></p>
<p><img src="/2018/10/06/vivadoHLS-0/5096-18986-tupian4.png" alt="img"></p>
<h2 id="第一个Vivado-HLS工程"><a href="#第一个Vivado-HLS工程" class="headerlink" title="第一个Vivado HLS工程"></a>第一个Vivado HLS工程</h2><p><a href="http://xilinx.eetrend.com/d6-xilinx/webinar/2016-07/10340.html" target="_blank" rel="external">http://xilinx.eetrend.com/d6-xilinx/webinar/2016-07/10340.html</a></p>
<p><a href="http://xilinx.eetrend.com/d6-xilinx/blog/2016-12/10734.html" target="_blank" rel="external">http://xilinx.eetrend.com/d6-xilinx/blog/2016-12/10734.html</a></p>
<p>对于Vivado Hls来说，输入包括Tesbench，C/C++源代码和Directives，相应的输出为IP Catalog，DSP和SysGen，特别的，一个工程只能有一个顶层函数用于综和，这个顶层函数下面的子函数也是可以被综合的，会生成相应的VHDL和Verilog代码，所以，C综合后的RTL代码结构通常是跟原始C描述的结构是一致的，除非是子函数功能很简单，所需要的逻辑量很小。 通常在main函数以下的函数都可以被综合，也就是说，并不是所有的C/C++都可以被综合，动态内存分配和涉及到操作系统层面的操作不可以被综合。 </p>
<h3 id="本部分结构框架："><a href="#本部分结构框架：" class="headerlink" title="本部分结构框架："></a>本部分结构框架：</h3><p>Creat New Project新建文档</p>
<p>C simulation</p>
<p>C systhesis</p>
<p>RTL级仿真</p>
<p>IP封装</p>
<p>总结</p>
<h3 id="1-Creat-New-Project新建文档"><a href="#1-Creat-New-Project新建文档" class="headerlink" title="1.Creat New Project新建文档"></a>1.Creat New Project新建文档</h3><p><img src="/2018/10/06/vivadoHLS-0/10734-27136-vivado_-1.png" alt="img"></p>
<p>​          新建一个Project name，点next（这里选取简单的4选1数据选择器为例，主要是说明流程）</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27137-vivado_-2.png" alt="img"></p>
<p>​    在Add Files里添加mux41.c文件，点next</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27138-vivado_-3.png" alt="img"></p>
<p>​    添加mux41_test测试文件，点next</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27139-vivado_-4.png" alt="img"></p>
<p>点Part，这里选择Board下面的Zedboard Zynq开发板，然后点OK和finish</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27140-vivado_-5.png" alt="img"></p>
<p>注释：<br>mux41.c代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mux41.h"</span></span></div><div class="line"><span class="function">int1 <span class="title">mux41</span><span class="params">(int1 sig_a, int1 sig_b,int1 sig_c,int1 sig_d, <span class="keyword">int</span> select)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(select==<span class="number">0</span>)</div><div class="line">       <span class="keyword">return</span> sig_a;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(select==<span class="number">1</span>)</div><div class="line">       <span class="keyword">return</span> sig_b;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(select==<span class="number">2</span>)</div><div class="line">       <span class="keyword">return</span> sig_c;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(select==<span class="number">3</span>)</div><div class="line">       <span class="keyword">return</span> sig_d;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>mux41.h代码：(头文件)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ap_cint.h&gt;</span></span></div></pre></td></tr></table></figure>
<p>mux41_tb代码：(testbench)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mux41.h"</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> res1 = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> res2 = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> res3 = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> res4 = <span class="number">0</span>;</div><div class="line">  res1=mux41(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">    res2=mux41(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);</div><div class="line">    res3=mux41(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>);</div><div class="line">    res4=mux41(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>);</div><div class="line">    <span class="keyword">if</span>(res1 &amp;&amp; res2 &amp;&amp; res3 &amp;&amp; res4)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"test passed, well done!\n"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-C-simulation"><a href="#2-C-simulation" class="headerlink" title="2.C simulation"></a>2.C simulation</h3><p>在菜单里Project&gt;Run C simulation，C simulation可以得到csim文件</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27141-vivado-6.png" alt="img"></p>
<p>从图中看到，可以看到test passed,well done!，证明结果是正确的：</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27142-vivado-7.png" alt="img"></p>
<h3 id="3-C-systhesis"><a href="#3-C-systhesis" class="headerlink" title="3.C systhesis:"></a>3.C systhesis:</h3><p><img src="/2018/10/06/vivadoHLS-0/10734-27143-vivado_-8.png" alt="img"></p>
<p>注意综合得到的verilog代码的可读性很差，不需要读懂，所以大多数优化都在C这个层面去做的，下面是综合后的verilog代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">// ==============================================================</div><div class="line">// RTL generated by Vivado(TM) HLS - High-Level Synthesis from C, C++ and SystemC</div><div class="line">// Version: 2016.3</div><div class="line">// Copyright (C) 1986-2016 Xilinx, Inc. All Rights Reserved.</div><div class="line">// </div><div class="line">// ===========================================================</div><div class="line">`timescale 1 ns / 1 ps </div><div class="line">(* CORE_GENERATION_INFO="mux41,hls_ip_2016_3,&#123;HLS_INPUT_TYPE=c,HLS_INPUT_FLOAT=0,HLS_INPUT_FIXED=1,HLS_INPUT_PART=xc7z020clg484-</div><div class="line">1,HLS_INPUT_CLOCK=10.000000,HLS_INPUT_ARCH=others,HLS_SYN_CLOCK=5.258000,HLS_SYN_LAT=0,HLS_SYN_TPT=none,HLS_SYN_MEM=0,HLS_SYN_DSP=0,HLS_SYN_FF=0,HLS_SYN_LUT=41&#125;" *)</div><div class="line">module mux41 (</div><div class="line">        ap_start,</div><div class="line">        ap_done,</div><div class="line">        ap_idle,</div><div class="line">        ap_ready,</div><div class="line">        sig_a,</div><div class="line">        sig_b,</div><div class="line">        sig_c,</div><div class="line">        sig_d,</div><div class="line">        select_r,</div><div class="line">        ap_return</div><div class="line">);</div><div class="line">parameter    ap_const_lv32_0 = 32'b00000000000000000000000000000000;</div><div class="line">parameter    ap_const_lv32_1 = 32'b1;</div><div class="line">parameter    ap_const_lv32_2 = 32'b10;</div><div class="line">input   ap_start;</div><div class="line">output   ap_done;</div><div class="line">output   ap_idle;</div><div class="line">output   ap_ready;</div><div class="line">input  [0:0] sig_a;</div><div class="line">input  [0:0] sig_b;</div><div class="line">input  [0:0] sig_c;</div><div class="line">input  [0:0] sig_d;</div><div class="line">input  [31:0] select_r;</div><div class="line">output  [0:0] ap_return;</div><div class="line">wire   [0:0] tmp_fu_60_p2;</div><div class="line">wire   [0:0] tmp_1_fu_66_p2;</div><div class="line">wire   [0:0] sel_tmp1_fu_86_p2;</div><div class="line">wire   [0:0] sel_tmp2_fu_92_p2;</div><div class="line">wire   [0:0] sel_tmp_fu_78_p3;</div><div class="line">wire   [0:0] tmp_2_fu_72_p2;</div><div class="line">wire   [0:0] tmp7_fu_106_p2;</div><div class="line">wire   [0:0] sel_tmp5_fu_112_p2;</div><div class="line">wire   [0:0] p_0_fu_98_p3;</div><div class="line">assign ap_done = ap_start;</div><div class="line">assign ap_idle = 1'b1;</div><div class="line">assign ap_ready = ap_start;</div><div class="line">assign ap_return = ((sel_tmp5_fu_112_p2[0:0] === 1'b1) ? p_0_fu_98_p3 : sig_d);</div><div class="line">assign p_0_fu_98_p3 = ((sel_tmp2_fu_92_p2[0:0] === 1'b1) ? sig_b : sel_tmp_fu_78_p3);</div><div class="line">assign sel_tmp1_fu_86_p2 = (tmp_fu_60_p2 ^ 1'b1);</div><div class="line">assign sel_tmp2_fu_92_p2 = (tmp_1_fu_66_p2 &amp; sel_tmp1_fu_86_p2);</div><div class="line">assign sel_tmp5_fu_112_p2 = (tmp7_fu_106_p2 | tmp_fu_60_p2);</div><div class="line">assign sel_tmp_fu_78_p3 = ((tmp_fu_60_p2[0:0] === 1'b1) ? sig_a : sig_c);</div><div class="line">assign tmp7_fu_106_p2 = (tmp_1_fu_66_p2 | tmp_2_fu_72_p2);</div><div class="line">assign tmp_1_fu_66_p2 = ((select_r == ap_const_lv32_1) ? 1'b1 : 1'b0);</div><div class="line">assign tmp_2_fu_72_p2 = ((select_r == ap_const_lv32_2) ? 1'b1 : 1'b0);</div><div class="line">assign tmp_fu_60_p2 = ((select_r == ap_const_lv32_0) ? 1'b1 : 1'b0);</div><div class="line">endmodule //mux41</div></pre></td></tr></table></figure>
<h3 id="4-RTL级仿真"><a href="#4-RTL级仿真" class="headerlink" title="4.RTL级仿真"></a>4.RTL级仿真</h3><p>在菜单里Solution&gt;RunC/RTL cosimulation，需要对Co-similation Dialog设置如下：</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27144-vivado-9.png" alt="img"></p>
<p>得到如下结果，我们会发现Verilog的Status是pass，证明C/RTL cosimulation成功:</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27145-vivado-10.png" alt="img"></p>
<p>然后我们点开波形查看窗口，此时会自动打开Vivado软件，从图中看到，mux41的功能正确：</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27146-vivado-11.png" alt="img"></p>
<h3 id="5-IP封装"><a href="#5-IP封装" class="headerlink" title="5.IP封装"></a>5.IP封装</h3><p>在菜单里Solution&gt;Export TL，设置如下：</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27147-vivado-12.png" alt="img"></p>
<p>IP封装后，会得到impl文件，其中就有我们所需要的三个子文件ip，verilog，vhdl</p>
<p><img src="/2018/10/06/vivadoHLS-0/10734-27148-vivado-13.png" alt="img"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>事实上，在整个流程中，用户先创建一个设计 C、C++ 或 SystemC 源代码，以及一个C的测试平台。随后需要用 GCC/G++或 Visual C++ 仿真器验证设计的系统行为。一旦行为设计运行良好，对应的测试台的问题全部解决，就可以通过 Vivado HLS Synthesis 运行设计，生成 RTL 设计，代码可以是 Verilog，也可以是 VHDL。有了 RTL 后，随即可以执行设计的 Verilog 或 VHDL 仿真，或使用工具的C封装器技术创建 SystemC 版本。然后可以进行System C架构级仿真，进一步根据之前创建的 C 测试平台，验证设计的架构行为和功能。设计固化后，就可以通过 Vivado 设计套件的物理实现流程来运行设计，将设计编程到器件上，在硬件中运行和/或使用 IP 封装器将设计转为可重用的 IP。随后使用 IP 集成器将 IP 集成到设计中，或在系统生成器 （System Generator） 中运行 IP。</p>
<h2 id="HLS进阶学习"><a href="#HLS进阶学习" class="headerlink" title="HLS进阶学习"></a>HLS进阶学习</h2><h3 id="初步学习计划"><a href="#初步学习计划" class="headerlink" title="初步学习计划"></a>初步学习计划</h3><p>HLS说到底是一个工具，作为工具，应用为先。</p>
<h4 id="第一步-利用教程和例程跑一个hls仿真"><a href="#第一步-利用教程和例程跑一个hls仿真" class="headerlink" title="第一步 利用教程和例程跑一个hls仿真"></a>第一步 利用教程和例程跑一个hls仿真</h4><p>详情参考ug871第二章 create a high-level synthesis project</p>
<p>以下仅对值得注意的地方进行记录</p>
<p>很好，我点进上文的参考代码链接，给我出现了以下界面</p>
<p><img src="/2018/10/06/vivadoHLS-0/1538791324962.png" alt="1538791324962"></p>
<p>我觉得事情不简单，下拉以后</p>
<p><img src="/2018/10/06/vivadoHLS-0/1538791380106.png" alt="1538791380106"></p>
<p>好的吧，出现最新版教程了。左边侧栏勾选tutorials,然后把document type 那边的user guides去掉。往下拉你就可以看到清纯不做作的ug871 2018.2。</p>
<p><img src="/2018/10/06/vivadoHLS-0/1538791548492.png" alt="1538791548492"></p>
<p>………………换文档肯定要跑路的啊！（不是）换文档肯定要看看有什么区别的啊！</p>
<p><img src="/2018/10/06/vivadoHLS-0/1538791799084.png" alt="1538791799084"></p>
<p>​                                                                           2018.2</p>
<p><img src="/2018/10/06/vivadoHLS-0/1538749785686.png" alt="1538749785686"></p>
<p>​                                                                              2013.1</p>
<p>初步判断没什么实质性区别，那好，我去看看操作。其实本来差别就不可能很大，主要是怕有一些操作不同。这个时候第一步就是打开我的<del>垃圾</del> vivado hls 2016.1，暗中观察一下初始GUI页面跟哪一版的教程更像。</p>
<p>然后我觉得我应该用新版教程了(っ•̀ω•́)っ✎⁾⁾。接下来这句话：详情参考ug871 2018.2 ch.2 hls introduction</p>
<p>哦好的吧，我本来想搞一个能看Waveforms的工程出来，然后发现ch2这章introduction的三个lab是在教软件使用方法。好吧，那我放一个我lab 2成功的截图好了。</p>
<p><img src="/2018/10/06/vivadoHLS-0/TIM图片201810061220.png" alt="TIM图片201810061220"></p>
<p>说一下体验，教程还是很详细的，基本都很顺。除了lab 2用commad prompt的时候，出了一点小问题。因为第一步要定位到introduction文件夹里，我一开始用cd 命令……然后就一点都不ok,查了才发现windows cd命令只能切当前盘内路径。</p>
<p>然后如果像我一样不按原设定路径安装的话，这部分修改大致如下：</p>
<p><img src="/2018/10/06/vivadoHLS-0/TIM图片20181006122457.png" alt="TIM图片20181006122457"></p>
<p>因为我混乱的路径就是……</p>
<p>E:\FileRecv\fpga\ug871-design-files\ug871-design-files\Introduction</p>
<p>这样的啊，然后我又习惯性地把fir_prj放到我平常放代码的地方，就不在lab1目录下。为了完成这个实验，那当然是！复制过来！！！</p>
<p>之后操作就一切正常。</p>
<p>总之官方教程文档很详细。只是编一个初始的小工程编译就花了不少时间，我已经感受到了来自vivado的威胁(Ｔ▽Ｔ)</p>
<p>心怀电路写C第一步，完成。</p>
<h4 id="第二步-利用手上的ug871和ug902文档研究官方例程和语法约束"><a href="#第二步-利用手上的ug871和ug902文档研究官方例程和语法约束" class="headerlink" title="第二步 利用手上的ug871和ug902文档研究官方例程和语法约束"></a>第二步 利用手上的ug871和ug902文档研究官方例程和语法约束</h4><p>ug871官方例程教程</p>
<p><img src="/2018/10/06/vivadoHLS-0/1538749785686.png" alt="1538749785686"></p>
<p>ug902语法约束</p>
<p><img src="/2018/10/06/vivadoHLS-0/1538789542511.png" alt="1538789542511"></p>
<h4 id="第三步-将hls运用在参赛项目上"><a href="#第三步-将hls运用在参赛项目上" class="headerlink" title="第三步 将hls运用在参赛项目上"></a>第三步 将hls运用在参赛项目上</h4><p>过程记录如下</p>
<h4 id="第四步-后期完善学习，记录一些可优化技巧"><a href="#第四步-后期完善学习，记录一些可优化技巧" class="headerlink" title="第四步 后期完善学习，记录一些可优化技巧"></a>第四步 后期完善学习，记录一些可优化技巧</h4>
  </div>
  <!--评论块-->
    

</article>
<nav class="post-nav">
  <!-- Prev Nav -->
    
  <a href="/2018/10/30/四旋翼PID调参笔记/" id="post_nav-newer" class="post-nav-content prev-content">
      新篇
  </a>
    


  <!-- Next Nav -->
    
  <a href="/2018/10/04/uCOSIII1/" id="post_nav-older" class="post-nav-content next-content">
      旧篇
  </a>
    
</nav>
<div class="post-toc-btn"><i class="material-icons">format_list_numbered</i></div>
<div class="post-toc-none"><p>(无)</p></div>
<div class="post-toc-box">
    <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#HLS学习"><span class="post-toc-number">1.</span> <span class="post-toc-text">HLS学习</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#HLS基础介绍"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">HLS基础介绍</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#HLS入门学习资料"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">HLS入门学习资料</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#第一个Vivado-HLS工程"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">第一个Vivado HLS工程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#本部分结构框架："><span class="post-toc-number">1.4.1.</span> <span class="post-toc-text">本部分结构框架：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-Creat-New-Project新建文档"><span class="post-toc-number">1.4.2.</span> <span class="post-toc-text">1.Creat New Project新建文档</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-C-simulation"><span class="post-toc-number">1.4.3.</span> <span class="post-toc-text">2.C simulation</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-C-systhesis"><span class="post-toc-number">1.4.4.</span> <span class="post-toc-text">3.C systhesis:</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-RTL级仿真"><span class="post-toc-number">1.4.5.</span> <span class="post-toc-text">4.RTL级仿真</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-IP封装"><span class="post-toc-number">1.4.6.</span> <span class="post-toc-text">5.IP封装</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#总结"><span class="post-toc-number">1.4.7.</span> <span class="post-toc-text">总结</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#HLS进阶学习"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">HLS进阶学习</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#初步学习计划"><span class="post-toc-number">1.5.1.</span> <span class="post-toc-text">初步学习计划</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#第一步-利用教程和例程跑一个hls仿真"><span class="post-toc-number">1.5.1.1.</span> <span class="post-toc-text">第一步 利用教程和例程跑一个hls仿真</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#第二步-利用手上的ug871和ug902文档研究官方例程和语法约束"><span class="post-toc-number">1.5.1.2.</span> <span class="post-toc-text">第二步 利用手上的ug871和ug902文档研究官方例程和语法约束</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#第三步-将hls运用在参赛项目上"><span class="post-toc-number">1.5.1.3.</span> <span class="post-toc-text">第三步 将hls运用在参赛项目上</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#第四步-后期完善学习，记录一些可优化技巧"><span class="post-toc-number">1.5.1.4.</span> <span class="post-toc-text">第四步 后期完善学习，记录一些可优化技巧</span></a></li></ol></li></ol></li></ol></li></ol>
</div>
<!--<div class="post-back"><i class="material-icons">arrow_back</i></div>-->
<script type="text/javascript">
    menu();
</script>
  </div>
</div>
<div id="bottom-outer">
  <div id="bottom-inner">
    <a  id="top-button" onfocus="this.blur();"><div class="up upinbody" style="background-color:#26A69A"><i class="material-icons material-up">vertical_align_top</i></div></a>


<p >Copyright ©  2017  SunnyFHY</p>
<p >Powered by <a href="https://hexo.io/" target="_blank"> Hexo </a> & Theme - <a href="https://github.com/moumao/hexo-theme-Vateral" target="_blank">Vateral</a></p>
<p style="font-size: 10px" id="footer-times" data-time="10/01/2018 00:00:00"></p>
<script>
    var beginTime=document.getElementById("footer-times").dataset.time
    function show_date_time(){
        var span=document.getElementById("footer-times")
        window.setTimeout("show_date_time()", 1000);
        BirthDay=new Date(beginTime);//初始日期
        today=new Date();
        timeold=(today.getTime()-BirthDay.getTime());
        sectimeold=timeold/1000
        secondsold=Math.floor(sectimeold);
        msPerDay=24*60*60*1000
        e_daysold=timeold/msPerDay
        daysold=Math.floor(e_daysold);
        e_hrsold=(e_daysold-daysold)*24;
        hrsold=Math.floor(e_hrsold);
        e_minsold=(e_hrsold-hrsold)*60;
        minsold=Math.floor((e_hrsold-hrsold)*60);
        seconds=Math.floor((e_minsold-minsold)*60);
        span.innerHTML="本站已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
    }
    show_date_time();
</script>

  </div>
</div>

<!--影集界面需要的资源-->



<!-- scripts list from theme config.yml -->

<script src="/js/jquery-3.1.1.min.js"></script>

<script src="/js/materialize.min.js"></script>

<script src="/js/main.min.js"></script>


<script>
    NProgress.start();
    NProgress.done();
    lazy();
    links();
    window.onpopstate = menu();
    //pjax操作
    $(document).pjax('a:not(.nopjax)', '#content-inner', {fragment:'#content-inner', timeout:8000});
    $(document).on('pjax:start', NProgress.start).on('pjax:end', NProgress.done)
        .on('pjax:end', () => {
            dowmdiv();
            lazy();
            toc();
            links();
            menu();
        });
</script>

</body>
</html>
